<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Facture ‚Äî FADEL DIGITAL ELECTRONICS</title>
  <style>
    :root{
      --emerald: #009999;
      --muted: #6b7280;
      --table-bg: #f7faf9;
      --paper: #ffffff;
      --max-width: 900px;
      font-family: "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    *{box-sizing:border-box}
    body{
      background:#f2f6f8;
      margin:0;
      padding:28px;
      color:#111827;
    }
    .sheet{
      max-width:var(--max-width);
      margin:0 auto;
      background:var(--paper);
      padding:26px 30px;
      border-radius:10px;
      box-shadow:0 10px 30px rgba(15,23,42,0.06);
    }
    header{
      border-bottom:1px solid #eef2f7;
      padding-bottom:14px;
      margin-bottom:14px;
      text-align:center;
    }
    .main-logo img {
      height:70px;
      object-fit:contain;
      margin-bottom:6px;
    }
    .main-logo h1 {
      font-size:22px;
      color:var(--emerald);
      margin:4px 0;
      letter-spacing:0.5px;
      font-weight:800;
    }
    .main-logo p {
      color:var(--muted);
      margin:2px 0;
      font-size:13px;
    }
    .main-logo .ninea {
      font-size:12px;
      color:#6b7280;
    }
    .meta p{margin:2px 0;font-size:13px;color:var(--muted);text-align:right}
    .two-col{display:flex;gap:12px;justify-content:space-between;margin:14px 0 8px;flex-wrap:wrap}
    .card{background:var(--table-bg);padding:10px 12px;border-radius:8px;min-width:200px;flex:1}
    .card b{display:block;margin-bottom:6px;color:#0f172a}

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:8px;
      font-size:13px;
      table-layout:fixed;
    }
    thead th{
      text-align:left;
      padding:12px 10px;
      background:var(--emerald);
      color:white;
      font-weight:700;
      font-size:13px;
    }
    thead th:nth-child(1){width:50%;}
    thead th:nth-child(2){width:10%;}
    thead th:nth-child(3){width:20%;}
    thead th:nth-child(4){width:15%;}
    thead th:nth-child(5){width:15%;}

    tbody td{padding:10px;border-bottom:1px solid #e6eef2;vertical-align:middle;word-wrap:break-word;}
    tbody tr:nth-child(even){background:#ffffff;}
    tbody tr:nth-child(odd){background:#fbfbfb;}

    input.cell{
      width:100%;
      border:none;
      background:transparent;
      font-size:13px;
      padding:4px 6px;
      outline:none;
      white-space:normal;
      word-break:break-word;
    }

    .right{text-align:right}
    .center{text-align:center}
    .action-btn{background:transparent;border:none;cursor:pointer;font-size:16px;padding:6px 8px;border-radius:6px}
    .action-btn.del{background:#ff4d4d;color:white}
    .action-btn.del:hover{opacity:0.9}
    .controls{display:flex;justify-content:flex-end;gap:10px;margin-top:10px;flex-wrap:wrap}
    .print-btn{background:var(--emerald);color:white;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:700}
    .print-btn.ghost{background:#f3fdfb;color:var(--emerald);border:1px solid rgba(0,153,153,0.12)}
    .totals{margin-top:18px;display:flex;justify-content:space-between;gap:12px;align-items:center;flex-wrap:wrap}
    .totals .left{color:var(--muted);font-size:13px}
    .totals .right{min-width:260px;text-align:center}
    .amount{font-size:20px;font-weight:800;color:var(--emerald);padding:10px 14px;border-radius:8px;background:linear-gradient(90deg,rgba(0,153,153,0.06),rgba(0,153,153,0.02));display:inline-block;box-shadow:0 6px 18px rgba(0,153,153,0.04)}
    .amount-words{margin-top:6px;font-size:13px;color:#0f172a;font-weight:600}

    footer{margin-top:26px;border-top:1px solid #eef2f7;padding-top:12px;color:#374151;font-size:12px;line-height:1.4}
    @media print{
      body{background:white;padding:0;}
      .controls,.print-btn{display:none!important}
      .sheet{box-shadow:none;border-radius:0;margin:0;padding:16mm}
      th:last-child,td:last-child{display:none!important}
      thead th{-webkit-print-color-adjust:exact;print-color-adjust:exact;}
    }
  </style>
</head>
<body>
  <div class="sheet" id="facture-sheet">
    <div class="controls" id="controls">
      <button class="print-btn ghost" id="btn-add">+ Ajouter un produit</button>
      <button class="print-btn ghost" id="btn-clear">üßπ R√©initialiser</button>
      <button class="print-btn" id="downloadPdf">‚¨áÔ∏è T√©l√©charger PDF</button>
    </div>

    <header>
      <div class="main-logo">
        <img src="logo.jpg" alt="Logo Fadel Digital" >
        <h1>FADEL DIGITAL ELECTRONICS</h1>
        <p>Dakar, Av Lamine Gu√®ye ‚Ä¢ T√©l : 77 299 05 00</p>
        <p class="ninea">NINEA : 010840040</p>
      </div>
    </header>

    <div class="meta">
      <p><strong>Facture N¬∞</strong> : <input id="invoice-number" class="cell" style="width:140px" value="FD-1025-01"></p>
      <p><strong>Date</strong> : <input id="invoice-date" class="cell" type="date"></p>
      <p><strong>Factur√© √† :</strong> <input id="client-name" class="cell client-input" placeholder="Nom du client"></p>
      <p>T√©l : <input id="client-phone" class="cell" placeholder="Num√©ro du client"></p>
      <p>Adresse : <input id="client-address" class="cell client-input" placeholder="Adresse du client"></p>
    </div>

    <main>
      <table id="items-table">
        <thead>
          <tr>
            <th>D√©signation</th>
            <th class="center">Quantit√©</th>
            <th class="right">Prix Unitaire (FCFA)</th>
            <th class="center">R√©f√©rence</th>
            <th class="center">Action</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="totals">
        <div class="left">
          <div><strong>Total :</strong> <span id="total">0</span> FCFA</div>
          <div style="margin-top:6px"><strong>Avance :</strong> <input id="avance" class="cell" style="width:120px" value="0"></div>
        </div>
        <div class="right">
          <div class="amount" id="remaining-amount">0 FCFA</div>
          <div class="amount-words" id="amount-words">Z√©ro franc CFA</div>
        </div>
      </div>

      <div style="margin-top:30px;text-align:right;">
        <p style="font-weight:700;font-size:14px;color:#009999;margin-bottom:10px;">
          ‚úÖ Garantie : 12 mois sur tous les produits achet√©s
        </p>
        <img src="./cachet.jpg" alt="Cachet Fadel Digital Electronics" style="width:180px;opacity:0.85;">
        <p style="margin-top:6px;font-weight:700;">Fadel Digital Electronics</p>
      </div>

      <footer>
        <p style="font-weight:700;margin:0 0 8px 0">Conditions & garantie :</p>
        <p>
          Les articles restent la propri√©t√© du vendeur jusqu'au paiement complet.<br/>
          Tous nos produits sont garantis (Cette garantie ne couvre pas les d√©t√©riorations caus√©es par : un mauvais d√©placement ou une mauvaise installation non conforme √† la notice, les surtensions, les √©crans cass√©s, ou les interventions non agr√©√©es).<br/>
          Les petits mat√©riels √©lectriques (mixeurs, bouilloires, ventilateurs...) ne sont pas garantis.
        </p>
        <p style="color:var(--muted);font-size:12px;margin-top:8px">Merci pour votre confiance !</p>
      </footer>
    </main>
  </div>

  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.2/html2pdf.bundle.min.js"></script>
  <script>
    function fmt(n){return (n||0).toLocaleString('fr-FR');}
    function parseNumber(s){return parseFloat(String(s).replace(/\s+/g,'').replace(/[^0-9\.\-]/g,''))||0;}
    function numberToWordsFr(n){const u=["z√©ro","un","deux","trois","quatre","cinq","six","sept","huit","neuf"];if(n<10)return u[n];return n.toString();}

    document.addEventListener("DOMContentLoaded",()=>{
      const tbody=document.querySelector("#items-table tbody");
      const totalEl=document.getElementById("total");
      const resteEl=document.getElementById("remaining-amount");
      const avance=document.getElementById("avance");
      const words=document.getElementById("amount-words");
      document.getElementById("btn-add").onclick=()=>{tbody.insertAdjacentHTML("beforeend",`<tr><td><input class="cell" placeholder="D√©signation"></td><td><input class="cell qty" type="number" value="1"></td><td><input class="cell price" type="number" value="0"></td><td><input class="cell ref" placeholder="R√©f."></td><td><button class="action-btn del">üóë</button></td></tr>`);refresh();}
      tbody.addEventListener("click",e=>{if(e.target.classList.contains("del")){e.target.closest("tr").remove();refresh();}});
      tbody.addEventListener("input",refresh);
      avance.oninput=refresh;
      function refresh(){
        let total=0;
        tbody.querySelectorAll("tr").forEach(tr=>{
          const q=parseNumber(tr.querySelector(".qty")?.value);
          const p=parseNumber(tr.querySelector(".price")?.value);
          total+=q*p;
        });
        totalEl.textContent=fmt(total);
        const rest=total-parseNumber(avance.value);
        resteEl.textContent=fmt(rest)+" FCFA";
        words.textContent=numberToWordsFr(rest)+" francs CFA";
      }
      document.getElementById("downloadPdf").onclick=function(){
        const element=document.getElementById("facture-sheet");
        const opt={
          margin:0.3,
          filename:"Facture.pdf",
          image:{type:"jpeg",quality:1},
          html2canvas:{scale:2,useCORS:true,allowTaint:true,backgroundColor:"#fff"},
          jsPDF:{unit:"in",format:"a4",orientation:"portrait"}
        };
        html2pdf().set(opt).from(element).save();
      };
    });
  </script>
</body>
</html>
